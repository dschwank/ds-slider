'use strict';
angular.module('ds.slider', []), angular.module('ds.slider').directive('dsSlider', ["$document","$log","dsSliderService",function(n,e,t){return{restrict:"EA",replace:!0,require:"^ngModel",scope:{min:"@",max:"@",step:"@?",data:"=?ngModel"},link:function(e,a,i,r){function o(n,e){return angular.element(n.querySelector(e))}function m(){return a[0].clientWidth-36}function u(n,a){var i;i=Math.ceil(t.calculatePer(n,g,a,parseFloat(e.min),parseFloat(e.max))),e.data[n]=i,e.data[n+"Per"]=(i-parseFloat(e.min))/g.multiplier*100,b?(e.$broadcast("dsSliderChange",e.data),e.$digest()):e.$apply(),x(n)}function l(n){return function(e){var t=e.originalEvent||e;P||(P=setTimeout(function(){u(n,(t.clientX-g.x)*g.perPx),P=void 0},h)),t.preventDefault()}}function d(e){var t=function(a){var i=a.originalEvent||a;i.preventDefault(),n.unbind("mousemove",e),n.unbind("mouseup",t)};return t}function c(n,t){var a=n.originalEvent||n;g.x=a.clientX,g.totalWidth=m(),g.min=e.data.min,g.minPer=e.data.minPer,g.max=e.data.max,g.maxPer=e.data.maxPer,g.step=e.step,g.multiplier=e.max-e.min,g.perPx=(e.max-e.min)/g.totalWidth,a.preventDefault()}function s(e){return function(t){c(t,"max"===e);var a=l(e);n.on("mousemove",a),n.on("mouseup",d(a))}}function p(){S={min:o(a[0],".minSlider"),positioner:o(a[0],".positioner"),max:o(a[0],".maxSlider")}}function f(){e.step=e.step||1,e.data=e.data||{min:e.min,max:e.max},e.data.minPer=(e.data.min-e.min)/(e.max-e.min)*100,e.data.maxPer=(e.data.max-e.min)/(e.max-e.min)*100,e.showShortInfo=i.enableShortInfo}function x(n){n?t.updateCSSPosition(S.positioner,n,e.data):(x("min"),x("max"))}function v(){S.min.on("mousedown",s("min")),S.max.on("mousedown",s("max")),x()}var P,S={},g={left:0,width:100},h=i.updateThrottle||20,b=i.enableBroadcast;i.enableApply;!function(){f(),p(),v()}()},templateUrl:"src/templates/dsSlider.tpl.html"}}]), angular.module('ds.slider').factory('dsSliderService', function () {
    function n(n, e, t, a, i) {
        var r = e[n] + t;
        return r -= r % e.step, r = 'max' === n ? r < e.min ? e.min : r > i ? i : r : a > r ? a : r > e.max ? e.max : r;
    }
    function e(n, e, t) {
        n.css({
            width: t.maxPer - t.minPer + '%',
            left: t.minPer + '%'
        });
    }
    return {
        calculatePer: function (e, t, a, i, r) {
            return n(e, t, a, i, r);
        },
        updateCSSPosition: function (n, t, a) {
            e(n, t, a);
        }
    };
});